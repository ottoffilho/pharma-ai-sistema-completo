<?xml version="1.0" encoding="UTF-8"?>
<prompt>
  <title>Refatoração UX – Página Nova Receita (Wizard de 2 Etapas)</title>

  <!--
    Este prompt será usado no Claude Code para gerar/alterar componentes React
    (TypeScript + Vite + shadcn/ui) dentro do projeto Pharma.AI.
    O objetivo é substituir o layout atual em colunas fixas por um fluxo em duas etapas
    (wizard), melhorando legibilidade e tornando o processo mais intuitivo.
  -->

  <context>
    <project>Pharma.AI – Módulo Atendimento</project>
    <filePath>src/pages/admin/pedidos/nova-receita.tsx</filePath>
    <techStack>React 18, TypeScript strict, Vite, shadcn/ui, Tailwind</techStack>
  </context>

  <overview>
    1. Dividir o fluxo em duas etapas claras: <step1 /> (Entrada) e <step2 /> (Validação).
    2. Remover o layout "split grid" que causa cortes de texto; usar layout flexível.
    3. Mostrar preview da receita em <drawer /> ou <dialog /> acionado por botão.
    4. Garantir acessibilidade, responsividade e atalhos de teclado.
  </overview>

  <requirements>
    <step number="1" id="Entrada">
      <description>Aba Upload OU Digitação Manual.</description>
      <actions>
        <action>Manter componentes existentes de upload e digitação.</action>
        <action>Adicionar botão primário "Avançar para Validação" que fica desabilitado até que exista extractedData.</action>
      </actions>
    </step>

    <step number="2" id="Validação">
      <description>Revisão dos dados extraídos/digitados.</description>
      <layout>Formulário ocupa 100% da largura; campos w-full e text-wrap.</layout>
      <preview>
        <component>RecipePreviewDrawer</component>
        <triggerButton>
          <icon>Image</icon>
          <label>Visualizar Receita</label>
          <shortcut>Alt+V</shortcut>
        </triggerButton>
      </preview>
      <actions>
        <action>Botões: Cancelar | Criar Pedido.</action>
        <action>Toast de sucesso após criação com links "Abrir Pedido" e "Voltar à lista".</action>
      </actions>
    </step>
  </requirements>

  <uiGuidelines>
    <typography>Base 16px, line-height 1.45.</typography>
    <buttons>Usar gradientes existentes; manter consistência com design system.</buttons>
    <responsiveness>
      Até lg: formulário stacked; FAB de ação fixa no footer mobile.</responsiveness>
  </uiGuidelines>

  <tasks>
    <task>Refatorar componente principal para <RecipeWizard /> com useState(step).</task>
    <task>Migrar lógica de processamento IA e manual para função handleNextStep().</task>
    <task>Remover toggle split/preview; substituir por Drawer.</task>
    <task>Atualizar imports e testes se necessário.</task>
  </tasks>

  <acceptanceCriteria>
    <criterion>Não deve haver texto cortado em 1366×768.</criterion>
    <criterion>Nenhum console error/lint error.</criterion>
    <criterion>Teste manual em desktop e mobile: fluxo completo até criar pedido.</criterion>
  </acceptanceCriteria>

  <notes>
    Usar componentes shadcn/ui (<Sheet />, <Dialog />, <Button />) – seguir padrões existentes.
    Cumprir todas regras de código do projeto: TypeScript estrito, hooks já implementados, React Query.
  </notes>
</prompt>
